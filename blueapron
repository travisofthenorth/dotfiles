alias sw='spring rails s -p5000'
alias psql_dev='psql -d blueapron_development'
alias restore_from_dump='pg_restore -vcOx -h localhost -d blueapron_development -j `sysctl -n hw.ncpu`'

alias prod_console='heroku run --size=performance-l console -a blueapron'
alias stg_console='heroku run console -a blueapron-staging'
alias h='heroku'
alias hr='heroku run'
alias hrc='hr console -a'
alias hconfig='heroku config -a blueapron'
alias restore_from_staging='heroku pg:backups restore $(heroku pg:backups public-url -a blueapron-staging) DATABASE_URL -a blueapron-travis'

function hconfig_search() { hconfig | grep -i $1; }
function purge_slug_cache() { heroku repo:gc -a $1 && heroku repo:purge_cache -a $1; }
function newrelic_deployment() { newrelic deployments -a $1 -e production -u travis -r `git log -n 1 --pretty=format:"%h"`; }

function restoredb_and_notify() {
  restore_from_dump $1; notify_me
}

function deploy_notifier() {
  sub=${1:-www}
  while [ "$(curl -s https://$sub.blueapron.com/version)" != "$(git log -n 1 --pretty=format:'%H')" ]; do sleep 2; done; terminal-notifier -message "Latest version deployed" -title "$sub deploy" -sound "Alarm"
}
